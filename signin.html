<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Naya Hotel Bondo</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Chart.js Library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        /* Admin Dashboard Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background-color: #f5f5f5;
            overflow-x: hidden;
        }

        /* Top Navigation Bar */
        .admin-topbar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 70px;
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 30px;
            z-index: 1000;
        }

        .topbar-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .admin-logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .admin-logo img {
            width: 45px;
            height: 45px;
            object-fit: contain;
        }

        .admin-logo-text {
            font-size: 18px;
            font-weight: 600;
            color: #FF6B35;
        }

        .topbar-right {
            display: flex;
            align-items: center;
            gap: 25px;
        }

        .notification-bell {
            position: relative;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: #f5f5f5;
            transition: all 0.3s ease;
        }

        .notification-bell:hover {
            background: #e0e0e0;
        }

        .notification-bell svg {
            width: 22px;
            height: 22px;
            fill: #333;
        }

        .notification-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            background: #FF6B35;
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: 600;
            animation: pulse 2s infinite;
        }

        .notification-badge.hidden {
            display: none;
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1);
            }
        }

        /* Notification Dropdown */
        .notification-dropdown {
            position: absolute;
            top: 65px;
            right: 200px;
            width: 380px;
            max-height: 500px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 1001;
            overflow: hidden;
        }

        .notification-dropdown.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .notification-header {
            padding: 20px;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .notification-header h3 {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin: 0;
        }

        .mark-all-read {
            font-size: 12px;
            color: #FF6B35;
            cursor: pointer;
            font-weight: 500;
        }

        .mark-all-read:hover {
            text-decoration: underline;
        }

        .notification-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .notification-item {
            padding: 15px 20px;
            border-bottom: 1px solid #f5f5f5;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }

        .notification-item:hover {
            background: #f9f9f9;
        }

        .notification-item.unread {
            background: #fff5f0;
        }

        .notification-item.unread::before {
            content: '';
            position: absolute;
            left: 8px;
            top: 50%;
            transform: translateY(-50%);
            width: 6px;
            height: 6px;
            background: #FF6B35;
            border-radius: 50%;
        }

        .notification-content {
            margin-left: 10px;
        }

        .notification-title {
            font-size: 13px;
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
        }

        .notification-message {
            font-size: 12px;
            color: #666;
            margin-bottom: 6px;
            line-height: 1.4;
        }

        .notification-time {
            font-size: 11px;
            color: #999;
        }

        .notification-icon {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 8px;
        }

        .notification-icon.booking {
            background: #e3f2fd;
            color: #2196F3;
        }

        .notification-icon.customer {
            background: #f3e5f5;
            color: #9C27B0;
        }

        .notification-icon.enquiry {
            background: #fff3e0;
            color: #FF9800;
        }

        .notification-icon.newsletter {
            background: #e8f5e9;
            color: #4CAF50;
        }

        .notification-icon svg {
            width: 18px;
            height: 18px;
            fill: currentColor;
        }

        .no-notifications {
            padding: 40px 20px;
            text-align: center;
            color: #999;
            font-size: 14px;
        }

        .notification-footer {
            padding: 15px 20px;
            border-top: 1px solid #f0f0f0;
            text-align: center;
        }

        .view-all-notifications {
            color: #FF6B35;
            font-size: 13px;
            font-weight: 500;
            text-decoration: none;
        }

        .view-all-notifications:hover {
            text-decoration: underline;
        }

        .admin-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            padding: 8px 15px;
            border-radius: 25px;
            transition: all 0.3s ease;
        }

        .admin-profile:hover {
            background: #f5f5f5;
        }

        .profile-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #FF6B35, #C1121F);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 16px;
        }

        .profile-info {
            display: flex;
            flex-direction: column;
        }

        .profile-name {
            font-size: 14px;
            font-weight: 600;
            color: #333;
        }

        .profile-role {
            font-size: 12px;
            color: #888;
        }

        .profile-dropdown {
            position: absolute;
            top: 60px;
            right: 30px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            width: 200px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 1001;
        }

        .profile-dropdown.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px 20px;
            color: #666;
            text-decoration: none;
            transition: all 0.3s ease;
            border-bottom: 1px solid #f0f0f0;
        }

        .dropdown-item:first-child {
            border-radius: 10px 10px 0 0;
        }

        .dropdown-item:last-child {
            border-bottom: none;
            border-radius: 0 0 10px 10px;
        }

        .dropdown-item:hover {
            background: #f5f5f5;
            color: #FF6B35;
        }

        .dropdown-icon {
            width: 18px;
            height: 18px;
            fill: currentColor;
        }

        /* Sidebar */
        .admin-sidebar {
            position: fixed;
            left: 0;
            top: 70px;
            width: 260px;
            height: calc(100vh - 70px);
            background: white;
            box-shadow: 2px 0 10px rgba(0,0,0,0.05);
            overflow-y: auto;
            padding: 30px 0;
            z-index: 999;
        }

        .sidebar-menu {
            list-style: none;
        }

        .sidebar-item {
            margin-bottom: 5px;
        }

        .sidebar-link {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 30px;
            color: #666;
            text-decoration: none;
            transition: all 0.3s ease;
            font-size: 15px;
            font-weight: 500;
        }

        .sidebar-link:hover {
            background: #f5f5f5;
            color: #FF6B35;
        }

        .sidebar-link.active {
            background: linear-gradient(90deg, #FF6B35 0%, transparent 100%);
            color: #FF6B35;
            border-left: 4px solid #FF6B35;
        }

        .sidebar-icon {
            width: 22px;
            height: 22px;
            fill: currentColor;
        }

        /* Main Content Area */
        .admin-content {
            margin-left: 260px;
            margin-top: 70px;
            padding: 40px;
            min-height: calc(100vh - 70px);
        }

        .content-header {
            margin-bottom: 30px;
        }

        .content-title {
            font-size: 28px;
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
        }

        .content-subtitle {
            font-size: 14px;
            color: #888;
        }

        .content-body {
            background: white;
            border-radius: 10px;
            padding: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            min-height: 400px;
        }

        /* Dashboard Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 8px;
            padding: 18px 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            transition: all 0.3s ease;
            border-top: 3px solid transparent;
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .stat-card.bookings {
            border-top-color: #FF6B35;
        }

        .stat-card.customers {
            border-top-color: #4CAF50;
        }

        .stat-card.enquiries {
            border-top-color: #2196F3;
        }

        .stat-card.newsletter {
            border-top-color: #9C27B0;
        }

        .stat-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .stat-title {
            font-size: 11px;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        .stat-icon {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .stat-card.bookings .stat-icon {
            background: rgba(255, 107, 53, 0.1);
        }

        .stat-card.customers .stat-icon {
            background: rgba(76, 175, 80, 0.1);
        }

        .stat-card.enquiries .stat-icon {
            background: rgba(33, 150, 243, 0.1);
        }

        .stat-card.newsletter .stat-icon {
            background: rgba(156, 39, 176, 0.1);
        }

        .stat-icon svg {
            width: 18px;
            height: 18px;
        }

        .stat-card.bookings .stat-icon svg {
            fill: #FF6B35;
        }

        .stat-card.customers .stat-icon svg {
            fill: #4CAF50;
        }

        .stat-card.enquiries .stat-icon svg {
            fill: #2196F3;
        }

        .stat-card.newsletter .stat-icon svg {
            fill: #9C27B0;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            color: #333;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 11px;
            color: #999;
        }

        /* Quick Action Buttons */
        .quick-actions {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }

        .action-btn {
            flex: 1;
            padding: 15px 20px;
            border: none;
            border-radius: 8px;
            font-family: 'Montserrat', sans-serif;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            text-decoration: none;
        }

        .action-btn svg {
            width: 18px;
            height: 18px;
            fill: currentColor;
        }

        .action-btn.primary {
            background: linear-gradient(135deg, #FF6B35, #FF8C61);
            color: white;
        }

        .action-btn.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 53, 0.3);
        }

        .action-btn.secondary {
            background: linear-gradient(135deg, #4CAF50, #66BB6A);
            color: white;
        }

        .action-btn.secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
        }

        .action-btn.tertiary {
            background: linear-gradient(135deg, #2196F3, #42A5F5);
            color: white;
        }

        .action-btn.tertiary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(33, 150, 243, 0.3);
        }

        /* Charts Section */
        .charts-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 30px;
            width: 100%;
        }

        .chart-card {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.06);
            width: 100%;
            box-sizing: border-box;
        }

        .chart-header {
            margin-bottom: 20px;
        }

        .chart-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .chart-subtitle {
            font-size: 12px;
            color: #888;
        }

        .chart-body {
            height: 280px;
            width: 100%;
            display: block;
            background: transparent;
            border-radius: 8px;
            padding: 10px;
            position: relative;
        }

        .chart-body canvas {
            width: 100% !important;
            height: 100% !important;
            display: block !important;
        }

        .placeholder-content {
            display: flex;
            align-items: center;
            justify-content: center;
            color: #888;
            padding: 60px 20px;
        }

        /* Customers Module Styles */
        .module-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .search-filter-container {
            display: flex;
            gap: 15px;
            flex: 1;
            max-width: 600px;
        }

        .search-box {
            flex: 1;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 12px 40px 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-family: 'Montserrat', sans-serif;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .search-box input:focus {
            outline: none;
            border-color: #FF6B35;
            box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
        }

        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            width: 18px;
            height: 18px;
            fill: #999;
        }

        .filter-select {
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-family: 'Montserrat', sans-serif;
            font-size: 14px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-select:focus {
            outline: none;
            border-color: #FF6B35;
            box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
        }

        .add-customer-btn {
            padding: 12px 25px;
            background: linear-gradient(135deg, #FF6B35, #FF8C61);
            color: white;
            border: none;
            border-radius: 8px;
            font-family: 'Montserrat', sans-serif;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .add-customer-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 53, 0.3);
        }

        .add-customer-btn svg {
            width: 16px;
            height: 16px;
            fill: white;
        }

        /* Customer Table */
        .table-container {
            background: white;
            border-radius: 10px;
            overflow-x: auto;
            overflow-y: visible;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .customer-table {
            width: 100%;
            min-width: 800px;
            border-collapse: collapse;
        }

        .customer-table thead {
            background: #f9f9f9;
        }

        .customer-table th {
            padding: 15px 20px;
            text-align: left;
            font-size: 13px;
            font-weight: 600;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 2px solid #eee;
            white-space: nowrap;
        }

        .customer-table td {
            padding: 18px 20px;
            border-bottom: 1px solid #f0f0f0;
            font-size: 14px;
            color: #333;
            white-space: nowrap;
            vertical-align: middle;
        }

        /* Allow wrapping for services column only */
        .customer-table td:has(.services-container) {
            white-space: normal;
            vertical-align: top;
        }

        /* Ensure actions column stays horizontal */
        .customer-table td:has(.action-buttons) {
            white-space: nowrap;
            min-width: 380px;
        }

        .customer-table tbody tr {
            transition: all 0.2s ease;
        }

        .customer-table tbody tr:hover {
            background: #f9f9f9;
        }

        .customer-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #FF6B35, #C1121F);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 14px;
        }

        .customer-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .customer-name {
            font-weight: 600;
            color: #333;
        }

        .customer-email {
            font-size: 12px;
            color: #888;
            margin-top: 2px;
        }

        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-badge.active {
            background: #e8f5e9;
            color: #4CAF50;
        }

        .status-badge.inactive {
            background: #ffebee;
            color: #f44336;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .action-icon-btn {
            width: 32px;
            height: 32px;
            border: none;
            background: #f5f5f5;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .action-icon-btn:hover {
            background: #FF6B35;
        }

        .action-icon-btn svg {
            width: 16px;
            height: 16px;
            fill: #666;
        }

        .action-icon-btn:hover svg {
            fill: white;
        }

        .no-data {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }

        /* Add Customer Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .modal-overlay.show {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            padding: 25px 30px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
            color: #333;
        }

        .modal-close {
            width: 32px;
            height: 32px;
            border: none;
            background: #f5f5f5;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: #FF6B35;
        }

        .modal-close svg {
            width: 18px;
            height: 18px;
            fill: #666;
        }

        .modal-close:hover svg {
            fill: white;
        }

        .modal-body {
            padding: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .form-input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-family: 'Montserrat', sans-serif;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #FF6B35;
            box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
        }

        .form-select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-family: 'Montserrat', sans-serif;
            font-size: 14px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .form-select:focus {
            outline: none;
            border-color: #FF6B35;
            box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
        }

        .modal-footer {
            padding: 20px 30px;
            border-top: 1px solid #eee;
            display: flex;
            gap: 15px;
            justify-content: flex-end;
        }

        .btn-cancel {
            padding: 12px 25px;
            border: 1px solid #ddd;
            background: white;
            color: #666;
            border-radius: 8px;
            font-family: 'Montserrat', sans-serif;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-cancel:hover {
            background: #f5f5f5;
        }

        .btn-submit {
            padding: 12px 25px;
            border: none;
            background: linear-gradient(135deg, #FF6B35, #FF8C61);
            color: white;
            border-radius: 8px;
            font-family: 'Montserrat', sans-serif;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 53, 0.3);
        }

        .btn-submit:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .charts-container {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .admin-sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }

            .admin-content {
                margin-left: 0;
                padding: 20px;
            }

            .profile-info {
                display: none;
            }

            .admin-logo-text {
                font-size: 16px;
            }

            .quick-actions {
                flex-direction: column;
            }

            .charts-container {
                grid-template-columns: 1fr;
            }
        }

        /* Enquiry Module Styles */
        .stats-summary {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .stat-summary-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: white;
            padding: 12px 16px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            min-width: 80px;
        }

        .stat-summary-item .stat-number {
            font-size: 24px;
            font-weight: 700;
            color: #FF6B35;
            line-height: 1;
        }

        .stat-summary-item .stat-text {
            font-size: 11px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-top: 2px;
        }

        /* Enquiry Details Modal Styles */
        .enquiry-details-content {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 10px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .detail-row.full-width {
            flex-direction: column;
            align-items: stretch;
        }

        .detail-row strong {
            color: #333;
            font-weight: 600;
            min-width: 120px;
        }

        .detail-row span {
            color: #666;
            text-align: right;
            word-break: break-word;
        }

        .detail-row.full-width strong {
            margin-bottom: 8px;
        }

        .message-content {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 6px;
            border-left: 3px solid #FF6B35;
            white-space: pre-wrap;
            word-wrap: break-word;
            line-height: 1.5;
            color: #444;
        }

        .status-select {
            padding: 6px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: white;
            color: #333;
            font-size: 13px;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .btn-danger:hover {
            background: #c82333;
            transform: translateY(-1px);
        }

        /* Enquiry Table Specific Styles */
        .enquiry-message-preview {
            max-width: 200px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            cursor: pointer;
            color: #666;
        }

        .enquiry-message-preview:hover {
            color: #FF6B35;
            text-decoration: underline;
        }

        .enquiry-id {
            font-family: 'Courier New', monospace;
            font-size: 11px;
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 3px;
            color: #666;
        }

        /* Status badges for enquiries */
        .status-badge.new {
            background: #28a745;
            color: white;
        }

        .status-badge.in-progress {
            background: #ffc107;
            color: #212529;
        }

        .status-badge.resolved {
            background: #6c757d;
            color: white;
        }

        /* Customer Status Badges */
        .status-badge.pending {
            background: #ffc107;
            color: #212529;
        }

        .status-badge.completed {
            background: #28a745;
            color: white;
        }

        .status-badge.cancelled {
            background: #dc3545;
            color: white;
        }

        /* Services Section Styles */
        #servicesContainer {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 10px;
        }

        .service-item {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .service-select {
            flex: 1;
        }

        .btn-remove-service {
            padding: 8px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            width: 36px;
            height: 36px;
        }

        .btn-remove-service:hover {
            background: #c82333;
            transform: scale(1.05);
        }

        .btn-add-service {
            padding: 10px 15px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: 'Montserrat', sans-serif;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            width: fit-content;
        }

        .btn-add-service:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        /* Action Buttons in Table */
        .action-buttons {
            display: flex;
            gap: 6px;
            align-items: center;
            justify-content: flex-start;
            flex-wrap: nowrap;
            white-space: nowrap;
        }

        .action-btn-table {
            padding: 5px 8px;
            border: none;
            border-radius: 5px;
            font-size: 11px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
            font-family: 'Montserrat', sans-serif;
        }

        .action-btn-table svg {
            width: 14px;
            height: 14px;
            fill: currentColor;
        }

        .action-btn-table.view {
            background: #17a2b8;
            color: white;
        }

        .action-btn-table.view:hover {
            background: #138496;
            transform: translateY(-2px);
        }

        .action-btn-table.edit {
            background: #ffc107;
            color: #212529;
        }

        .action-btn-table.edit:hover {
            background: #e0a800;
            transform: translateY(-2px);
        }

        .action-btn-table.complete {
            background: #28a745;
            color: white;
        }

        .action-btn-table.complete:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .action-btn-table.delete {
            background: #dc3545;
            color: white;
        }

        .action-btn-table.delete:hover {
            background: #c82333;
            transform: translateY(-2px);
        }

        /* Services Badge Display */
        .services-badge {
            display: block;
            background: #e3f2fd;
            color: #1976d2;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
            margin: 3px 0;
            white-space: nowrap;
            text-align: center;
        }

        .services-container {
            display: flex;
            flex-direction: column;
            gap: 3px;
            max-width: 200px;
            align-items: flex-start;
            padding: 2px 0;
        }

        /* Ensure services cell displays vertically */
        .customer-table tbody tr td:nth-child(4) {
            white-space: normal;
            vertical-align: top;
            padding-top: 15px;
        }

        /* Ensure actions column stays horizontal (9th column) */
        .customer-table tbody tr td:nth-child(9) {
            white-space: nowrap;
            min-width: 380px;
            vertical-align: middle;
        }
    </style>
</head>
<body>
    <!-- Top Navigation Bar -->
    <div class="admin-topbar">
        <div class="topbar-left">
            <div class="admin-logo">
                <img src="images/image.png" alt="Naya Hotel Logo">
                <span class="admin-logo-text">NAYA HOTEL ADMIN</span>
            </div>
        </div>
        <div class="topbar-right">
            <div class="notification-bell">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2zm-2 1H8v-6c0-2.48 1.51-4.5 4-4.5s4 2.02 4 4.5v6z"/>
                </svg>
                <span class="notification-badge hidden">0</span>
            </div>
            <div class="admin-profile">
                <div class="profile-avatar">A</div>
                <div class="profile-info">
                    <span class="profile-name">Admin User</span>
                    <span class="profile-role">Administrator</span>
                </div>
            </div>
        </div>

        <!-- Notification Dropdown -->
        <div class="notification-dropdown" id="notificationDropdown">
            <div class="notification-header">
                <h3>Notifications</h3>
                <span class="mark-all-read" id="markAllRead">Mark all as read</span>
            </div>
            <div class="notification-list" id="notificationList">
                <div class="no-notifications">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="#ddd">
                        <path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/>
                    </svg>
                    <p>No new notifications</p>
                </div>
            </div>
            <div class="notification-footer">
                <a href="#" class="view-all-notifications">View All Notifications</a>
            </div>
        </div>

        <!-- Profile Dropdown -->
        <div class="profile-dropdown" id="profileDropdown">
            <a href="#profile" class="dropdown-item">
                <svg class="dropdown-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                </svg>
                <span>Profile</span>
            </a>
            <a href="index.html" class="dropdown-item">
                <svg class="dropdown-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"/>
                </svg>
                <span>Logout</span>
            </a>
        </div>
    </div>

    <!-- Sidebar -->
    <aside class="admin-sidebar">
        <ul class="sidebar-menu">
            <li class="sidebar-item">
                <a href="#dashboard" class="sidebar-link active">
                    <svg class="sidebar-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/>
                    </svg>
                    <span>Dashboard</span>
                </a>
            </li>
            <li class="sidebar-item">
                <a href="#customers" class="sidebar-link">
                    <svg class="sidebar-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/>
                    </svg>
                    <span>Customers</span>
                </a>
            </li>
            <li class="sidebar-item">
                <a href="#bookings" class="sidebar-link">
                    <svg class="sidebar-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V10h14v10zM9 14H7v-2h2v2zm4 0h-2v-2h2v2zm4 0h-2v-2h2v2zm-8 4H7v-2h2v2zm4 0h-2v-2h2v2zm4 0h-2v-2h2v2z"/>
                    </svg>
                    <span>Bookings</span>
                </a>
            </li>
            <li class="sidebar-item">
                <a href="#enquiries" class="sidebar-link">
                    <svg class="sidebar-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"/>
                    </svg>
                    <span>Enquiries</span>
                </a>
            </li>
            <li class="sidebar-item">
                <a href="#newsletter" class="sidebar-link">
                    <svg class="sidebar-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                    </svg>
                    <span>Newsletter</span>
                </a>
            </li>
        </ul>
    </aside>

    <!-- Main Content Area -->
    <main class="admin-content">
        <div class="content-header">
            <h1 class="content-title">Dashboard</h1>
            <p class="content-subtitle">Welcome to Naya Hotel Admin Management System</p>
        </div>
        <div class="content-body">
            <!-- Dashboard Stats Cards -->
            <div class="stats-grid" id="dashboardStats">
                <div class="stat-card bookings">
                    <div class="stat-header">
                        <span class="stat-title">Bookings</span>
                        <div class="stat-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V10h14v10z"/>
                            </svg>
                        </div>
                    </div>
                    <div class="stat-value">0</div>
                    <div class="stat-label">Total bookings</div>
                </div>

                <div class="stat-card customers">
                    <div class="stat-header">
                        <span class="stat-title">Customers</span>
                        <div class="stat-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/>
                            </svg>
                        </div>
                    </div>
                    <div class="stat-value">0</div>
                    <div class="stat-label">Registered customers</div>
                </div>

                <div class="stat-card enquiries">
                    <div class="stat-header">
                        <span class="stat-title">Enquiries</span>
                        <div class="stat-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"/>
                            </svg>
                        </div>
                    </div>
                    <div class="stat-value">0</div>
                    <div class="stat-label">Pending enquiries</div>
                </div>

                <div class="stat-card newsletter">
                    <div class="stat-header">
                        <span class="stat-title">Newsletter</span>
                        <div class="stat-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                            </svg>
                        </div>
                    </div>
                    <div class="stat-value">0</div>
                    <div class="stat-label">Subscribers</div>
                </div>
            </div>

            <!-- Quick Action Buttons -->
            <div class="quick-actions">
                <button class="action-btn primary">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                    </svg>
                    <span>New Booking</span>
                </button>
                <button class="action-btn secondary">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm-9-2V7H4v3H1v2h3v3h2v-3h3v-2H6zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                    </svg>
                    <span>Add Customer</span>
                </button>
                <button class="action-btn tertiary">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                    </svg>
                    <span>Newsletter</span>
                </button>
            </div>

            <!-- Charts Section -->
            <div class="charts-container">
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">Booking Trends</h3>
                        <p class="chart-subtitle">Real-time booking analytics</p>
                    </div>
                    <div class="chart-body">
                        <canvas id="bookingChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">Customer Activity</h3>
                        <p class="chart-subtitle">User engagement metrics</p>
                    </div>
                    <div class="chart-body">
                        <canvas id="activityChart"></canvas>
                    </div>
                </div>

                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">Client Behavior</h3>
                        <p class="chart-subtitle">Visitor interactions</p>
                    </div>
                    <div class="chart-body">
                        <canvas id="behaviorChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Placeholder for other content -->
            <div class="placeholder-content" id="otherContent" style="display: none;">
                <p>Content will be displayed here...</p>
            </div>

            <!-- Customers Module -->
            <div id="customersModule" style="display: none;">
                <div class="module-header">
                    <div class="search-filter-container">
                        <div class="search-box">
                            <input type="text" id="customerSearch" placeholder="Search customers...">
                            <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
                            </svg>
                        </div>
                        <select class="filter-select" id="customerFilter">
                            <option value="all">All Customers</option>
                            <option value="pending">Pending</option>
                            <option value="completed">Completed</option>
                            <option value="in-progress">In Progress</option>
                            <option value="cancelled">Cancelled</option>
                        </select>
                    </div>
                    <button class="add-customer-btn" id="addCustomerBtn">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                        </svg>
                        <span>Add Customer</span>
                    </button>
                </div>

                <div class="table-container">
                    <table class="customer-table">
                        <thead>
                            <tr>
                                <th>Customer Name</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Services</th>
                                <th>Amount Paid</th>
                                <th>Check-In</th>
                                <th>Check-Out</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="customersTableBody">
                            <tr>
                                <td colspan="9" class="no-data">No customers found</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Bookings Module -->
            <div id="bookingsModule" style="display: none;">
                <div class="module-header">
                    <div class="search-filter-container">
                        <div class="search-box">
                            <input type="text" id="bookingSearch" placeholder="Search bookings...">
                            <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
                            </svg>
                        </div>
                        <select class="filter-select" id="bookingFilter">
                            <option value="all">All Bookings</option>
                            <option value="pending">Pending</option>
                            <option value="confirmed">Confirmed</option>
                            <option value="cancelled">Cancelled</option>
                        </select>
                    </div>
                    <button class="add-customer-btn" id="addBookingBtn">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                        </svg>
                        <span>Manual Booking</span>
                    </button>
                </div>

                <div class="table-container">
                    <table class="customer-table">
                        <thead>
                            <tr>
                                <th>Booking ID</th>
                                <th>Guest Name</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Check-in</th>
                                <th>Check-out</th>
                                <th>Room Type</th>
                                <th>Guests</th>
                                <th>Special Requests</th>
                                <th>Total Amount</th>
                                <th>Status</th>
                                <th>Source</th>
                                <th>Created At</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="bookingsTableBody">
                            <tr>
                                <td colspan="14" class="no-data">No bookings found</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Enquiries Module -->
            <div id="enquiriesModule" style="display: none;">
                <div class="module-header">
                    <div class="search-filter-container">
                        <div class="search-box">
                            <input type="text" id="enquirySearch" placeholder="Search enquiries...">
                            <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
                            </svg>
                        </div>
                        <select id="enquiryFilter" class="filter-select">
                            <option value="all">All Status</option>
                            <option value="new">New</option>
                            <option value="in-progress">In Progress</option>
                            <option value="resolved">Resolved</option>
                        </select>
                    </div>
                    <div class="stats-summary">
                        <div class="stat-summary-item">
                            <span class="stat-number" id="totalEnquiries">0</span>
                            <span class="stat-text">Total</span>
                        </div>
                        <div class="stat-summary-item">
                            <span class="stat-number" id="newEnquiries">0</span>
                            <span class="stat-text">New</span>
                        </div>
                        <div class="stat-summary-item">
                            <span class="stat-number" id="pendingEnquiries">0</span>
                            <span class="stat-text">Pending</span>
                        </div>
                    </div>
                </div>

                <div class="table-container">
                    <table class="customer-table">
                        <thead>
                            <tr>
                                <th>Enquiry ID</th>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Subject</th>
                                <th>Message</th>
                                <th>Status</th>
                                <th>Submitted</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="enquiriesTableBody">
                            <tr>
                                <td colspan="9" class="no-data">No enquiries found</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Newsletter Module -->
            <div id="newsletterModule" style="display: none;">
                <div class="module-header">
                    <div class="search-filter-container">
                        <div class="search-box">
                            <input type="text" id="newsletterSearch" placeholder="Search subscribers...">
                            <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
                            </svg>
                        </div>
                        <select id="newsletterFilter" class="filter-select">
                            <option value="all">All Status</option>
                            <option value="active">Active</option>
                            <option value="unsubscribed">Unsubscribed</option>
                        </select>
                    </div>
                    <div class="stats-summary">
                        <div class="stat-summary-item">
                            <span class="stat-number" id="totalSubscribers">0</span>
                            <span class="stat-text">Total</span>
                        </div>
                        <div class="stat-summary-item">
                            <span class="stat-number" id="activeSubscribers">0</span>
                            <span class="stat-text">Active</span>
                        </div>
                        <div class="stat-summary-item">
                            <span class="stat-number" id="todaySubscribers">0</span>
                            <span class="stat-text">Today</span>
                        </div>
                    </div>
                </div>

                <div class="table-container">
                    <table class="customer-table">
                        <thead>
                            <tr>
                                <th>Subscriber ID</th>
                                <th>Email Address</th>
                                <th>Status</th>
                                <th>Subscribed Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="newsletterTableBody">
                            <tr>
                                <td colspan="5" class="no-data">No subscribers found</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>

    <!-- Add Customer Modal -->
    <div class="modal-overlay" id="addCustomerModal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h2 class="modal-title">Add New Customer</h2>
                <button class="modal-close" id="closeModal">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                    </svg>
                </button>
            </div>
            <form id="addCustomerForm">
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label" for="customerName">Full Name *</label>
                        <input type="text" id="customerName" class="form-input" placeholder="Enter customer name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="customerEmail">Email Address *</label>
                        <input type="email" id="customerEmail" class="form-input" placeholder="customer@example.com" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="customerPhone">Phone Number *</label>
                        <input type="tel" id="customerPhone" class="form-input" placeholder="+254 700 000 000" required>
                    </div>
                    
                    <!-- Services Section -->
                    <div class="form-group">
                        <label class="form-label">Services *</label>
                        <div id="servicesContainer">
                            <div class="service-item">
                                <select class="form-select service-select" required>
                                    <option value="">Select a service</option>
                                    <option value="Room Booking">Room Booking</option>
                                    <option value="Restaurant">Restaurant</option>
                                    <option value="Bar Services">Bar Services</option>
                                    <option value="Conference Hall">Conference Hall</option>
                                    <option value="Event Space">Event Space</option>
                                    <option value="Catering">Catering</option>
                                    <option value="Laundry">Laundry</option>
                                    <option value="Spa & Wellness">Spa & Wellness</option>
                                    <option value="Airport Transfer">Airport Transfer</option>
                                    <option value="Tour Guide">Tour Guide</option>
                                </select>
                                <button type="button" class="btn-remove-service" style="display: none;">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18">
                                        <path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <button type="button" class="btn-add-service" id="addServiceBtn">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16">
                                <path fill="currentColor" d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                            </svg>
                            Add Another Service
                        </button>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="amountPaid">Amount Paid (KSH) *</label>
                        <input type="number" id="amountPaid" class="form-input" placeholder="0.00" min="0" step="0.01" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="checkInDate">Check-In Date *</label>
                        <input type="date" id="checkInDate" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="checkInTime">Check-In Time *</label>
                        <input type="time" id="checkInTime" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="checkOutDate">Check-Out Date *</label>
                        <input type="date" id="checkOutDate" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="checkOutTime">Check-Out Time *</label>
                        <input type="time" id="checkOutTime" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="customerStatus">Status *</label>
                        <select id="customerStatus" class="form-select" required>
                            <option value="pending">Pending</option>
                            <option value="in-progress">In Progress</option>
                            <option value="completed">Completed</option>
                            <option value="cancelled">Cancelled</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn-cancel" id="cancelModal">Cancel</button>
                    <button type="submit" class="btn-submit">Add Customer</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Booking Modal -->
    <div class="modal-overlay" id="addBookingModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Manual Booking</h2>
                <button class="modal-close" id="closeBookingModal">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                    </svg>
                </button>
            </div>
            <form id="addBookingForm">
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label" for="guestName">Guest Name *</label>
                        <input type="text" id="guestName" class="form-input" placeholder="Enter guest name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="guestEmail">Email Address *</label>
                        <input type="email" id="guestEmail" class="form-input" placeholder="guest@example.com" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="guestPhone">Phone Number *</label>
                        <input type="tel" id="guestPhone" class="form-input" placeholder="+254 700 000 000" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="checkIn">Check-in Date *</label>
                        <input type="date" id="checkIn" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="checkOut">Check-out Date *</label>
                        <input type="date" id="checkOut" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="roomType">Room Type *</label>
                        <select id="roomType" class="form-select" required>
                            <option value="">Select room type</option>
                            <option value="Standard Room">Standard Room</option>
                            <option value="Deluxe Room">Deluxe Room</option>
                            <option value="Suite">Suite</option>
                            <option value="Family Room">Family Room</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="guests">Number of Guests *</label>
                        <input type="number" id="guests" class="form-input" min="1" placeholder="2" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="bookingStatus">Status</label>
                        <select id="bookingStatus" class="form-select">
                            <option value="pending">Pending</option>
                            <option value="confirmed">Confirmed</option>
                            <option value="cancelled">Cancelled</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn-cancel" id="cancelBookingModal">Cancel</button>
                    <button type="submit" class="btn-submit">Create Booking</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Enquiry Details Modal -->
    <div class="modal-overlay" id="enquiryDetailsModal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2 class="modal-title">Enquiry Details</h2>
                <button class="modal-close" id="closeEnquiryModal">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="enquiry-details-content">
                    <div class="detail-row">
                        <strong>Enquiry ID:</strong>
                        <span id="detailEnquiryId">-</span>
                    </div>
                    <div class="detail-row">
                        <strong>Name:</strong>
                        <span id="detailName">-</span>
                    </div>
                    <div class="detail-row">
                        <strong>Email:</strong>
                        <span id="detailEmail">-</span>
                    </div>
                    <div class="detail-row">
                        <strong>Phone:</strong>
                        <span id="detailPhone">-</span>
                    </div>
                    <div class="detail-row">
                        <strong>Subject:</strong>
                        <span id="detailSubject">-</span>
                    </div>
                    <div class="detail-row">
                        <strong>Submitted:</strong>
                        <span id="detailSubmitted">-</span>
                    </div>
                    <div class="detail-row">
                        <strong>Status:</strong>
                        <select id="detailStatus" class="status-select">
                            <option value="new">New</option>
                            <option value="in-progress">In Progress</option>
                            <option value="resolved">Resolved</option>
                        </select>
                    </div>
                    <div class="detail-row full-width">
                        <strong>Message:</strong>
                        <div class="message-content" id="detailMessage">-</div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-cancel" id="cancelEnquiryModal">Close</button>
                <button type="button" class="btn-submit" id="updateEnquiryStatus">Update Status</button>
                <button type="button" class="btn-danger" id="deleteEnquiry">Delete</button>
            </div>
        </div>
    </div>

    <!-- View Customer Modal -->
    <div class="modal-overlay" id="viewCustomerModal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h2 class="modal-title">Customer Details</h2>
                <button class="modal-close" id="closeViewCustomerModal">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="enquiry-details-content">
                    <div class="detail-row">
                        <strong>Customer Name:</strong>
                        <span id="viewCustomerName">-</span>
                    </div>
                    <div class="detail-row">
                        <strong>Email:</strong>
                        <span id="viewCustomerEmail">-</span>
                    </div>
                    <div class="detail-row">
                        <strong>Phone:</strong>
                        <span id="viewCustomerPhone">-</span>
                    </div>
                    <div class="detail-row full-width">
                        <strong>Services:</strong>
                        <div id="viewCustomerServices" class="services-container">-</div>
                    </div>
                    <div class="detail-row">
                        <strong>Amount Paid:</strong>
                        <span id="viewCustomerAmount">-</span>
                    </div>
                    <div class="detail-row">
                        <strong>Check-In:</strong>
                        <span id="viewCustomerCheckIn">-</span>
                    </div>
                    <div class="detail-row">
                        <strong>Check-Out:</strong>
                        <span id="viewCustomerCheckOut">-</span>
                    </div>
                    <div class="detail-row">
                        <strong>Status:</strong>
                        <span id="viewCustomerStatus">-</span>
                    </div>
                    <div class="detail-row">
                        <strong>Created At:</strong>
                        <span id="viewCustomerCreated">-</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-cancel" id="cancelViewCustomerModal">Close</button>
            </div>
        </div>
    </div>

    <!-- Edit Customer Modal -->
    <div class="modal-overlay" id="editCustomerModal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h2 class="modal-title">Edit Customer</h2>
                <button class="modal-close" id="closeEditCustomerModal">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                    </svg>
                </button>
            </div>
            <form id="editCustomerForm">
                <input type="hidden" id="editCustomerId">
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label" for="editCustomerName">Full Name *</label>
                        <input type="text" id="editCustomerName" class="form-input" placeholder="Enter customer name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="editCustomerEmail">Email Address *</label>
                        <input type="email" id="editCustomerEmail" class="form-input" placeholder="customer@example.com" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="editCustomerPhone">Phone Number *</label>
                        <input type="tel" id="editCustomerPhone" class="form-input" placeholder="+254 700 000 000" required>
                    </div>
                    
                    <!-- Services Section -->
                    <div class="form-group">
                        <label class="form-label">Services *</label>
                        <div id="editServicesContainer">
                        </div>
                        <button type="button" class="btn-add-service" id="editAddServiceBtn">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16">
                                <path fill="currentColor" d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                            </svg>
                            Add Another Service
                        </button>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="editAmountPaid">Amount Paid (KSH) *</label>
                        <input type="number" id="editAmountPaid" class="form-input" placeholder="0.00" min="0" step="0.01" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="editCheckInDate">Check-In Date *</label>
                        <input type="date" id="editCheckInDate" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="editCheckInTime">Check-In Time *</label>
                        <input type="time" id="editCheckInTime" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="editCheckOutDate">Check-Out Date *</label>
                        <input type="date" id="editCheckOutDate" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="editCheckOutTime">Check-Out Time *</label>
                        <input type="time" id="editCheckOutTime" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="editCustomerStatus">Status *</label>
                        <select id="editCustomerStatus" class="form-select" required>
                            <option value="pending">Pending</option>
                            <option value="in-progress">In Progress</option>
                            <option value="completed">Completed</option>
                            <option value="cancelled">Cancelled</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn-cancel" id="cancelEditCustomerModal">Cancel</button>
                    <button type="submit" class="btn-submit">Update Customer</button>
                </div>
            </form>
        </div>
    </div>

    <script type="module">
        // Firebase Configuration and Initialization
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, onValue, push, set, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCT_6WJjJInYpNujwsw6jPRxcaiOuusMJc",
            authDomain: "naya-elite-hotel.firebaseapp.com",
            databaseURL: "https://naya-elite-hotel-default-rtdb.firebaseio.com",
            projectId: "naya-elite-hotel",
            storageBucket: "naya-elite-hotel.firebasestorage.app",
            messagingSenderId: "1087501013471",
            appId: "1:1087501013471:web:e5838687c9601c16f3346a",
            measurementId: "G-5QX8FTNHJ7"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // Global variables for charts
        let bookingChart, activityChart, behaviorChart;
        let allBookings = {};
        let allCustomers = {};
        let allEnquiries = {};
        let allNewsletters = {};

        // Real-time Dashboard Statistics
        function updateDashboardStats() {
            // Listen to bookings
            const bookingsRef = ref(database, 'bookings');
            onValue(bookingsRef, (snapshot) => {
                if (snapshot.exists()) {
                    allBookings = snapshot.val();
                    const totalBookings = Object.keys(allBookings).length;
                    document.querySelector('.stat-card.bookings .stat-value').textContent = totalBookings;
                } else {
                    allBookings = {};
                    document.querySelector('.stat-card.bookings .stat-value').textContent = '0';
                }
                updateCharts();
            });

            // Listen to customers
            const customersRef = ref(database, 'customers');
            onValue(customersRef, (snapshot) => {
                if (snapshot.exists()) {
                    allCustomers = snapshot.val();
                    const totalCustomers = Object.keys(allCustomers).length;
                    document.querySelector('.stat-card.customers .stat-value').textContent = totalCustomers;
                } else {
                    allCustomers = {};
                    document.querySelector('.stat-card.customers .stat-value').textContent = '0';
                }
                updateCharts();
            });

            // Listen to enquiries (contact-enquiries)
            const enquiriesRef = ref(database, 'contact-enquiries');
            onValue(enquiriesRef, (snapshot) => {
                if (snapshot.exists()) {
                    allEnquiries = snapshot.val();
                    const totalEnquiries = Object.keys(allEnquiries).length;
                    document.querySelector('.stat-card.enquiries .stat-value').textContent = totalEnquiries;
                } else {
                    allEnquiries = {};
                    document.querySelector('.stat-card.enquiries .stat-value').textContent = '0';
                }
                updateCharts();
            });

            // Listen to newsletter subscribers
            const newsletterRef = ref(database, 'newsletter-subscribers');
            onValue(newsletterRef, (snapshot) => {
                if (snapshot.exists()) {
                    allNewsletters = snapshot.val();
                    const totalSubscribers = Object.keys(allNewsletters).length;
                    document.querySelector('.stat-card.newsletter .stat-value').textContent = totalSubscribers;
                } else {
                    allNewsletters = {};
                    document.querySelector('.stat-card.newsletter .stat-value').textContent = '0';
                }
                updateCharts();
            });
        }

        // Update charts with real-time data
        function updateCharts() {
            updateBookingChart();
            updateActivityChart();
            updateBehaviorChart();
        }

        function updateBookingChart() {
            if (!bookingChart) return;

            // Get last 6 months of booking data
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            const currentMonth = new Date().getMonth();
            const last6Months = [];
            const bookingCounts = [];

            for (let i = 5; i >= 0; i--) {
                const monthIndex = (currentMonth - i + 12) % 12;
                last6Months.push(months[monthIndex]);
                
                // Count bookings for this month
                let count = 0;
                Object.values(allBookings).forEach(booking => {
                    if (booking.checkInDate) {
                        const bookingDate = new Date(booking.checkInDate);
                        if (bookingDate.getMonth() === monthIndex) {
                            count++;
                        }
                    }
                });
                bookingCounts.push(count);
            }

            bookingChart.data.labels = last6Months;
            bookingChart.data.datasets[0].data = bookingCounts;
            bookingChart.update();
        }

        function updateActivityChart() {
            if (!activityChart) return;

            // Get customer activity for the last 7 days
            const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            const activityData = [0, 0, 0, 0, 0, 0, 0];

            Object.values(allCustomers).forEach(customer => {
                if (customer.createdAt) {
                    const customerDate = new Date(customer.createdAt);
                    const dayOfWeek = customerDate.getDay();
                    activityData[dayOfWeek]++;
                }
            });

            activityChart.data.datasets[0].data = activityData;
            activityChart.update();
        }

        function updateBehaviorChart() {
            if (!behaviorChart) return;

            // Calculate customer status distribution
            let activeCount = 0;
            let completedCount = 0;
            let pendingCount = 0;

            Object.values(allCustomers).forEach(customer => {
                const status = customer.status || 'pending';
                if (status === 'active' || status === 'in-progress') {
                    activeCount++;
                } else if (status === 'completed') {
                    completedCount++;
                } else {
                    pendingCount++;
                }
            });

            behaviorChart.data.datasets[0].data = [pendingCount, activeCount, completedCount];
            behaviorChart.update();
        }

        // Initialize dashboard on load
        updateDashboardStats();

        // ========================================
        // REAL-TIME NOTIFICATION SYSTEM
        // ========================================
        
        let notifications = [];
        let unreadCount = 0;
        const notificationBell = document.querySelector('.notification-bell');
        const notificationBadge = document.querySelector('.notification-badge');
        const notificationDropdown = document.getElementById('notificationDropdown');
        const notificationList = document.getElementById('notificationList');
        const markAllReadBtn = document.getElementById('markAllRead');

        // Toggle notification dropdown
        notificationBell.addEventListener('click', function(e) {
            e.stopPropagation();
            notificationDropdown.classList.toggle('show');
            
            // Close profile dropdown if open
            document.getElementById('profileDropdown').classList.remove('show');
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            if (!notificationDropdown.contains(e.target) && !notificationBell.contains(e.target)) {
                notificationDropdown.classList.remove('show');
            }
        });

        // Mark all as read
        markAllReadBtn.addEventListener('click', function() {
            notifications.forEach(notif => notif.read = true);
            updateNotificationUI();
        });

        // Format time ago
        function timeAgo(timestamp) {
            const now = new Date();
            const date = new Date(timestamp);
            const seconds = Math.floor((now - date) / 1000);
            
            if (seconds < 60) return 'Just now';
            if (seconds < 3600) return Math.floor(seconds / 60) + ' min ago';
            if (seconds < 86400) return Math.floor(seconds / 3600) + ' hours ago';
            if (seconds < 604800) return Math.floor(seconds / 86400) + ' days ago';
            return date.toLocaleDateString();
        }

        // Create notification HTML
        function createNotificationHTML(notification) {
            const iconType = notification.type || 'booking';
            const iconSVG = {
                booking: '<path d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V10h14v10z"/>',
                customer: '<path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/>',
                enquiry: '<path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"/>',
                newsletter: '<path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>'
            };

            return `
                <div class="notification-item ${notification.read ? '' : 'unread'}" data-id="${notification.id}">
                    <div class="notification-icon ${iconType}">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            ${iconSVG[iconType]}
                        </svg>
                    </div>
                    <div class="notification-content">
                        <div class="notification-title">${notification.title}</div>
                        <div class="notification-message">${notification.message}</div>
                        <div class="notification-time">${timeAgo(notification.timestamp)}</div>
                    </div>
                </div>
            `;
        }

        // Update notification UI
        function updateNotificationUI() {
            // Update badge
            unreadCount = notifications.filter(n => !n.read).length;
            if (unreadCount > 0) {
                notificationBadge.textContent = unreadCount > 9 ? '9+' : unreadCount;
                notificationBadge.classList.remove('hidden');
            } else {
                notificationBadge.classList.add('hidden');
            }

            // Update notification list
            if (notifications.length === 0) {
                notificationList.innerHTML = `
                    <div class="no-notifications">
                        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="#ddd">
                            <path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"/>
                        </svg>
                        <p>No new notifications</p>
                    </div>
                `;
            } else {
                // Sort by timestamp (newest first)
                const sortedNotifications = [...notifications].sort((a, b) => 
                    new Date(b.timestamp) - new Date(a.timestamp)
                );
                
                notificationList.innerHTML = sortedNotifications
                    .slice(0, 10) // Show only last 10 notifications
                    .map(notif => createNotificationHTML(notif))
                    .join('');

                // Add click handlers to mark as read
                notificationList.querySelectorAll('.notification-item').forEach(item => {
                    item.addEventListener('click', function() {
                        const id = this.getAttribute('data-id');
                        const notification = notifications.find(n => n.id === id);
                        if (notification) {
                            notification.read = true;
                            updateNotificationUI();
                        }
                    });
                });
            }
        }

        // Add notification
        function addNotification(type, title, message) {
            const notification = {
                id: Date.now().toString(),
                type: type,
                title: title,
                message: message,
                timestamp: new Date().toISOString(),
                read: false
            };
            
            notifications.unshift(notification);
            
            // Keep only last 50 notifications
            if (notifications.length > 50) {
                notifications = notifications.slice(0, 50);
            }
            
            updateNotificationUI();

            // Play notification sound (optional)
            // playNotificationSound();
        }

        // Listen for new bookings
        const bookingsRef = ref(database, 'bookings');
        let isFirstBookingLoad = true;
        onValue(bookingsRef, (snapshot) => {
            if (isFirstBookingLoad) {
                isFirstBookingLoad = false;
                return;
            }
            
            if (snapshot.exists()) {
                const bookings = snapshot.val();
                const bookingKeys = Object.keys(bookings);
                const latestKey = bookingKeys[bookingKeys.length - 1];
                const latestBooking = bookings[latestKey];
                
                addNotification(
                    'booking',
                    'New Booking Received',
                    `${latestBooking.name} booked ${latestBooking.roomType} for ${latestBooking.checkInDate}`
                );
            }
        });

        // Listen for new customers
        const customersRef = ref(database, 'customers');
        let isFirstCustomerLoad = true;
        onValue(customersRef, (snapshot) => {
            if (isFirstCustomerLoad) {
                isFirstCustomerLoad = false;
                return;
            }
            
            if (snapshot.exists()) {
                const customers = snapshot.val();
                const customerKeys = Object.keys(customers);
                const latestKey = customerKeys[customerKeys.length - 1];
                const latestCustomer = customers[latestKey];
                
                addNotification(
                    'customer',
                    'New Customer Registered',
                    `${latestCustomer.name} (${latestCustomer.email}) has been added`
                );
            }
        });

        // Listen for new enquiries
        const enquiriesRef = ref(database, 'contact-enquiries');
        let isFirstEnquiryLoad = true;
        onValue(enquiriesRef, (snapshot) => {
            if (isFirstEnquiryLoad) {
                isFirstEnquiryLoad = false;
                return;
            }
            
            if (snapshot.exists()) {
                const enquiries = snapshot.val();
                const enquiryKeys = Object.keys(enquiries);
                const latestKey = enquiryKeys[enquiryKeys.length - 1];
                const latestEnquiry = enquiries[latestKey];
                
                addNotification(
                    'enquiry',
                    'New Contact Enquiry',
                    `${latestEnquiry.name} sent a message: "${latestEnquiry.message.substring(0, 50)}..."`
                );
            }
        });

        // Listen for new newsletter subscribers
        const newsletterRef = ref(database, 'newsletter-subscribers');
        let isFirstNewsletterLoad = true;
        onValue(newsletterRef, (snapshot) => {
            if (isFirstNewsletterLoad) {
                isFirstNewsletterLoad = false;
                return;
            }
            
            if (snapshot.exists()) {
                const subscribers = snapshot.val();
                const subscriberKeys = Object.keys(subscribers);
                const latestKey = subscriberKeys[subscriberKeys.length - 1];
                const latestSubscriber = subscribers[latestKey];
                
                addNotification(
                    'newsletter',
                    'New Newsletter Subscriber',
                    `${latestSubscriber.email} subscribed to the newsletter`
                );
            }
        });

        // Initialize notification UI
        updateNotificationUI();

        // ========================================
        // END OF NOTIFICATION SYSTEM
        // ========================================

        // Real-time customer data listener
        function loadCustomers() {
            const customersRef = ref(database, 'customers');
            onValue(customersRef, (snapshot) => {
                const tableBody = document.getElementById('customersTableBody');
                tableBody.innerHTML = '';

                if (snapshot.exists()) {
                    const customers = snapshot.val();
                    Object.keys(customers).forEach(key => {
                        const customer = customers[key];
                        const row = createCustomerRow(key, customer);
                        tableBody.innerHTML += row;
                    });
                } else {
                    tableBody.innerHTML = '<tr><td colspan="9" class="no-data">No customers found</td></tr>';
                }
            });
        }

        // Make loadCustomers globally available
        window.loadCustomers = loadCustomers;

        // Create customer table row
        function createCustomerRow(id, customer) {
            const statusClass = customer.status || 'pending';
            
            // Format services
            const services = customer.services || [];
            const servicesHtml = services.length > 0 
                ? services.map(s => `<span class="services-badge">${s}</span>`).join('')
                : '<span style="color: #999;">No services</span>';
            
            // Format dates
            const checkIn = customer.checkInDate && customer.checkInTime 
                ? `${customer.checkInDate} ${customer.checkInTime}` 
                : 'N/A';
            const checkOut = customer.checkOutDate && customer.checkOutTime 
                ? `${customer.checkOutDate} ${customer.checkOutTime}` 
                : 'N/A';
            
            return `
                <tr data-customer-id="${id}">
                    <td>${customer.name || 'N/A'}</td>
                    <td>${customer.email || 'N/A'}</td>
                    <td>${customer.phone || 'N/A'}</td>
                    <td>
                        <div class="services-container">
                            ${servicesHtml}
                        </div>
                    </td>
                    <td>KSH ${parseFloat(customer.amountPaid || 0).toLocaleString()}</td>
                    <td>${checkIn}</td>
                    <td>${checkOut}</td>
                    <td><span class="status-badge ${statusClass}">${statusClass.charAt(0).toUpperCase() + statusClass.slice(1)}</span></td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn-table view" data-id="${id}" onclick="viewCustomer('${id}')">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                    <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                                </svg>
                                View
                            </button>
                            <button class="action-btn-table edit" data-id="${id}" onclick="editCustomer('${id}')">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                    <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
                                </svg>
                                Edit
                            </button>
                            <button class="action-btn-table complete" data-id="${id}" onclick="completeCustomer('${id}')">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                    <path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"/>
                                </svg>
                                Complete
                            </button>
                            <button class="action-btn-table delete" data-id="${id}" onclick="deleteCustomer('${id}')">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                    <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                                </svg>
                                Delete
                            </button>
                        </div>
                    </td>
                </tr>
            `;
        }

        // Search functionality
        document.getElementById('customerSearch')?.addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const rows = document.querySelectorAll('#customersTableBody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        });

        // Filter functionality
        document.getElementById('customerFilter')?.addEventListener('change', function(e) {
            const filterValue = e.target.value.toLowerCase();
            const rows = document.querySelectorAll('#customersTableBody tr');
            
            rows.forEach(row => {
                if (filterValue === 'all') {
                    row.style.display = '';
                } else {
                    const status = row.querySelector('.status-badge');
                    if (status) {
                        const statusText = status.textContent.toLowerCase();
                        row.style.display = statusText === filterValue ? '' : 'none';
                    }
                }
            });
        });

        // Add customer button
        document.getElementById('addCustomerBtn')?.addEventListener('click', function() {
            const modal = document.getElementById('addCustomerModal');
            modal.classList.add('show');
        });

        // Close modal buttons
        document.getElementById('closeModal')?.addEventListener('click', function() {
            const modal = document.getElementById('addCustomerModal');
            modal.classList.remove('show');
            document.getElementById('addCustomerForm').reset();
        });

        document.getElementById('cancelModal')?.addEventListener('click', function() {
            const modal = document.getElementById('addCustomerModal');
            modal.classList.remove('show');
            document.getElementById('addCustomerForm').reset();
        });

        // Close modal when clicking outside
        document.getElementById('addCustomerModal')?.addEventListener('click', function(e) {
            if (e.target === this) {
                this.classList.remove('show');
                document.getElementById('addCustomerForm').reset();
            }
        });

        // Handle form submission
        document.getElementById('addCustomerForm')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('customerName').value;
            const email = document.getElementById('customerEmail').value;
            const phone = document.getElementById('customerPhone').value;
            const amountPaid = document.getElementById('amountPaid').value;
            const checkInDate = document.getElementById('checkInDate').value;
            const checkInTime = document.getElementById('checkInTime').value;
            const checkOutDate = document.getElementById('checkOutDate').value;
            const checkOutTime = document.getElementById('checkOutTime').value;
            const status = document.getElementById('customerStatus').value;
            
            // Collect all selected services
            const services = [];
            document.querySelectorAll('#servicesContainer .service-select').forEach(select => {
                if (select.value) {
                    services.push(select.value);
                }
            });
            
            const customersRef = ref(database, 'customers');
            const newCustomerRef = push(customersRef);
            
            set(newCustomerRef, {
                name: name,
                email: email,
                phone: phone,
                services: services,
                amountPaid: parseFloat(amountPaid),
                checkInDate: checkInDate,
                checkInTime: checkInTime,
                checkOutDate: checkOutDate,
                checkOutTime: checkOutTime,
                status: status,
                createdAt: new Date().toISOString()
            }).then(() => {
                // Close modal and reset form
                document.getElementById('addCustomerModal').classList.remove('show');
                document.getElementById('addCustomerForm').reset();
                // Reset services container to one service
                document.getElementById('servicesContainer').innerHTML = `
                    <div class="service-item">
                        <select class="form-select service-select" required>
                            <option value="">Select a service</option>
                            <option value="Room Booking">Room Booking</option>
                            <option value="Restaurant">Restaurant</option>
                            <option value="Bar Services">Bar Services</option>
                            <option value="Conference Hall">Conference Hall</option>
                            <option value="Event Space">Event Space</option>
                            <option value="Catering">Catering</option>
                            <option value="Laundry">Laundry</option>
                            <option value="Spa & Wellness">Spa & Wellness</option>
                            <option value="Airport Transfer">Airport Transfer</option>
                            <option value="Tour Guide">Tour Guide</option>
                        </select>
                        <button type="button" class="btn-remove-service" style="display: none;">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18">
                                <path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                            </svg>
                        </button>
                    </div>
                `;
                alert('Customer added successfully!');
            }).catch((error) => {
                alert('Error adding customer: ' + error.message);
            });
        });

        // Add Service Button Handler
        document.getElementById('addServiceBtn')?.addEventListener('click', function() {
            const container = document.getElementById('servicesContainer');
            const serviceItem = document.createElement('div');
            serviceItem.className = 'service-item';
            serviceItem.innerHTML = `
                <select class="form-select service-select" required>
                    <option value="">Select a service</option>
                    <option value="Room Booking">Room Booking</option>
                    <option value="Restaurant">Restaurant</option>
                    <option value="Bar Services">Bar Services</option>
                    <option value="Conference Hall">Conference Hall</option>
                    <option value="Event Space">Event Space</option>
                    <option value="Catering">Catering</option>
                    <option value="Laundry">Laundry</option>
                    <option value="Spa & Wellness">Spa & Wellness</option>
                    <option value="Airport Transfer">Airport Transfer</option>
                    <option value="Tour Guide">Tour Guide</option>
                </select>
                <button type="button" class="btn-remove-service">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18">
                        <path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                    </svg>
                </button>
            `;
            container.appendChild(serviceItem);
            updateRemoveButtons();
        });

        // Remove Service Button Handler (Event Delegation)
        document.addEventListener('click', function(e) {
            if (e.target.closest('.btn-remove-service')) {
                const serviceItem = e.target.closest('.service-item');
                serviceItem.remove();
                updateRemoveButtons();
            }
        });

        // Update visibility of remove buttons
        function updateRemoveButtons() {
            const services = document.querySelectorAll('#servicesContainer .service-item');
            services.forEach((item, index) => {
                const removeBtn = item.querySelector('.btn-remove-service');
                if (services.length === 1) {
                    removeBtn.style.display = 'none';
                } else {
                    removeBtn.style.display = 'flex';
                }
            });
        }

        // Edit Service Management for Edit Modal
        document.getElementById('editAddServiceBtn')?.addEventListener('click', function() {
            const container = document.getElementById('editServicesContainer');
            const serviceItem = document.createElement('div');
            serviceItem.className = 'service-item';
            serviceItem.innerHTML = `
                <select class="form-select service-select" required>
                    <option value="">Select a service</option>
                    <option value="Room Booking">Room Booking</option>
                    <option value="Restaurant">Restaurant</option>
                    <option value="Bar Services">Bar Services</option>
                    <option value="Conference Hall">Conference Hall</option>
                    <option value="Event Space">Event Space</option>
                    <option value="Catering">Catering</option>
                    <option value="Laundry">Laundry</option>
                    <option value="Spa & Wellness">Spa & Wellness</option>
                    <option value="Airport Transfer">Airport Transfer</option>
                    <option value="Tour Guide">Tour Guide</option>
                </select>
                <button type="button" class="btn-remove-service">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18">
                        <path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                    </svg>
                </button>
            `;
            container.appendChild(serviceItem);
            updateEditRemoveButtons();
        });

        function updateEditRemoveButtons() {
            const services = document.querySelectorAll('#editServicesContainer .service-item');
            services.forEach((item, index) => {
                const removeBtn = item.querySelector('.btn-remove-service');
                if (services.length === 1) {
                    removeBtn.style.display = 'none';
                } else {
                    removeBtn.style.display = 'flex';
                }
            });
        }

        // View Customer Function
        window.viewCustomer = function(customerId) {
            const customerRef = ref(database, 'customers/' + customerId);
            onValue(customerRef, (snapshot) => {
                if (snapshot.exists()) {
                    const customer = snapshot.val();
                    
                    document.getElementById('viewCustomerName').textContent = customer.name || 'N/A';
                    document.getElementById('viewCustomerEmail').textContent = customer.email || 'N/A';
                    document.getElementById('viewCustomerPhone').textContent = customer.phone || 'N/A';
                    
                    // Display services
                    const servicesContainer = document.getElementById('viewCustomerServices');
                    if (customer.services && customer.services.length > 0) {
                        servicesContainer.innerHTML = customer.services.map(s => 
                            `<span class="services-badge">${s}</span>`
                        ).join('');
                    } else {
                        servicesContainer.innerHTML = '<span style="color: #999;">No services</span>';
                    }
                    
                    document.getElementById('viewCustomerAmount').textContent = `KSH ${parseFloat(customer.amountPaid || 0).toLocaleString()}`;
                    document.getElementById('viewCustomerCheckIn').textContent = 
                        `${customer.checkInDate || 'N/A'} ${customer.checkInTime || ''}`;
                    document.getElementById('viewCustomerCheckOut').textContent = 
                        `${customer.checkOutDate || 'N/A'} ${customer.checkOutTime || ''}`;
                    
                    const statusBadge = `<span class="status-badge ${customer.status}">${customer.status ? customer.status.charAt(0).toUpperCase() + customer.status.slice(1) : 'N/A'}</span>`;
                    document.getElementById('viewCustomerStatus').innerHTML = statusBadge;
                    document.getElementById('viewCustomerCreated').textContent = 
                        customer.createdAt ? new Date(customer.createdAt).toLocaleString() : 'N/A';
                    
                    document.getElementById('viewCustomerModal').classList.add('show');
                }
            }, { onlyOnce: true });
        };

        // Edit Customer Function
        window.editCustomer = function(customerId) {
            const customerRef = ref(database, 'customers/' + customerId);
            onValue(customerRef, (snapshot) => {
                if (snapshot.exists()) {
                    const customer = snapshot.val();
                    
                    document.getElementById('editCustomerId').value = customerId;
                    document.getElementById('editCustomerName').value = customer.name || '';
                    document.getElementById('editCustomerEmail').value = customer.email || '';
                    document.getElementById('editCustomerPhone').value = customer.phone || '';
                    document.getElementById('editAmountPaid').value = customer.amountPaid || '';
                    document.getElementById('editCheckInDate').value = customer.checkInDate || '';
                    document.getElementById('editCheckInTime').value = customer.checkInTime || '';
                    document.getElementById('editCheckOutDate').value = customer.checkOutDate || '';
                    document.getElementById('editCheckOutTime').value = customer.checkOutTime || '';
                    document.getElementById('editCustomerStatus').value = customer.status || 'pending';
                    
                    // Populate services
                    const servicesContainer = document.getElementById('editServicesContainer');
                    servicesContainer.innerHTML = '';
                    
                    const services = customer.services || [''];
                    services.forEach((service, index) => {
                        const serviceItem = document.createElement('div');
                        serviceItem.className = 'service-item';
                        serviceItem.innerHTML = `
                            <select class="form-select service-select" required>
                                <option value="">Select a service</option>
                                <option value="Room Booking" ${service === 'Room Booking' ? 'selected' : ''}>Room Booking</option>
                                <option value="Restaurant" ${service === 'Restaurant' ? 'selected' : ''}>Restaurant</option>
                                <option value="Bar Services" ${service === 'Bar Services' ? 'selected' : ''}>Bar Services</option>
                                <option value="Conference Hall" ${service === 'Conference Hall' ? 'selected' : ''}>Conference Hall</option>
                                <option value="Event Space" ${service === 'Event Space' ? 'selected' : ''}>Event Space</option>
                                <option value="Catering" ${service === 'Catering' ? 'selected' : ''}>Catering</option>
                                <option value="Laundry" ${service === 'Laundry' ? 'selected' : ''}>Laundry</option>
                                <option value="Spa & Wellness" ${service === 'Spa & Wellness' ? 'selected' : ''}>Spa & Wellness</option>
                                <option value="Airport Transfer" ${service === 'Airport Transfer' ? 'selected' : ''}>Airport Transfer</option>
                                <option value="Tour Guide" ${service === 'Tour Guide' ? 'selected' : ''}>Tour Guide</option>
                            </select>
                            <button type="button" class="btn-remove-service" style="display: ${services.length === 1 ? 'none' : 'flex'};">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18">
                                    <path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                                </svg>
                            </button>
                        `;
                        servicesContainer.appendChild(serviceItem);
                    });
                    
                    document.getElementById('editCustomerModal').classList.add('show');
                }
            }, { onlyOnce: true });
        };

        // Complete Customer Function
        window.completeCustomer = function(customerId) {
            if (confirm('Mark this customer as completed?')) {
                const customerRef = ref(database, 'customers/' + customerId);
                set(customerRef.child('status'), 'completed').then(() => {
                    alert('Customer marked as completed!');
                }).catch((error) => {
                    alert('Error updating status: ' + error.message);
                });
            }
        };

        // Delete Customer Function
        window.deleteCustomer = function(customerId) {
            if (confirm('Are you sure you want to delete this customer? This action cannot be undone.')) {
                const customerRef = ref(database, 'customers/' + customerId);
                remove(customerRef).then(() => {
                    alert('Customer deleted successfully!');
                }).catch((error) => {
                    alert('Error deleting customer: ' + error.message);
                });
            }
        };

        // Close View Customer Modal
        document.getElementById('closeViewCustomerModal')?.addEventListener('click', function() {
            document.getElementById('viewCustomerModal').classList.remove('show');
        });

        document.getElementById('cancelViewCustomerModal')?.addEventListener('click', function() {
            document.getElementById('viewCustomerModal').classList.remove('show');
        });

        // Close Edit Customer Modal
        document.getElementById('closeEditCustomerModal')?.addEventListener('click', function() {
            document.getElementById('editCustomerModal').classList.remove('show');
        });

        document.getElementById('cancelEditCustomerModal')?.addEventListener('click', function() {
            document.getElementById('editCustomerModal').classList.remove('show');
        });

        // Handle Edit Customer Form Submission
        document.getElementById('editCustomerForm')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const customerId = document.getElementById('editCustomerId').value;
            const name = document.getElementById('editCustomerName').value;
            const email = document.getElementById('editCustomerEmail').value;
            const phone = document.getElementById('editCustomerPhone').value;
            const amountPaid = document.getElementById('editAmountPaid').value;
            const checkInDate = document.getElementById('editCheckInDate').value;
            const checkInTime = document.getElementById('editCheckInTime').value;
            const checkOutDate = document.getElementById('editCheckOutDate').value;
            const checkOutTime = document.getElementById('editCheckOutTime').value;
            const status = document.getElementById('editCustomerStatus').value;
            
            // Collect all selected services
            const services = [];
            document.querySelectorAll('#editServicesContainer .service-select').forEach(select => {
                if (select.value) {
                    services.push(select.value);
                }
            });
            
            const customerRef = ref(database, 'customers/' + customerId);
            
            set(customerRef, {
                name: name,
                email: email,
                phone: phone,
                services: services,
                amountPaid: parseFloat(amountPaid),
                checkInDate: checkInDate,
                checkInTime: checkInTime,
                checkOutDate: checkOutDate,
                checkOutTime: checkOutTime,
                status: status,
                updatedAt: new Date().toISOString()
            }).then(() => {
                document.getElementById('editCustomerModal').classList.remove('show');
                alert('Customer updated successfully!');
            }).catch((error) => {
                alert('Error updating customer: ' + error.message);
            });
        });

        // Make loadCustomers available globally
        window.loadCustomers = loadCustomers;

        // Real-time bookings data listener
        function loadBookings() {
            const bookingsRef = ref(database, 'bookings');
            onValue(bookingsRef, (snapshot) => {
                const tableBody = document.getElementById('bookingsTableBody');
                tableBody.innerHTML = '';

                if (snapshot.exists()) {
                    const bookings = snapshot.val();
                    Object.keys(bookings).forEach(key => {
                        const booking = bookings[key];
                        const row = createBookingRow(key, booking);
                        tableBody.innerHTML += row;
                    });
                } else {
                    tableBody.innerHTML = '<tr><td colspan="9" class="no-data">No bookings found</td></tr>';
                }
            });
        }

        // Make loadBookings globally available
        window.loadBookings = loadBookings;

        // Create booking table row
        function createBookingRow(id, booking) {
            let statusClass = 'active';
            if (booking.status === 'confirmed') statusClass = 'active';
            else if (booking.status === 'cancelled') statusClass = 'inactive';
            
            // Format date/time
            const createdDate = booking.createdAt ? new Date(booking.createdAt).toLocaleDateString() : 'N/A';
            const createdTime = booking.createdAt ? new Date(booking.createdAt).toLocaleTimeString() : '';
            
            // Generate short booking ID
            const shortId = id.substring(0, 8);
            
            return `
                <tr data-booking-id="${id}">
                    <td><strong>#${shortId}</strong></td>
                    <td><strong>${booking.guestName || booking.fullName || booking.name || 'N/A'}</strong></td>
                    <td>${booking.email || 'N/A'}</td>
                    <td>${booking.phone || 'N/A'}</td>
                    <td>${booking.checkIn || booking.checkInDate || booking.checkin || 'N/A'}</td>
                    <td>${booking.checkOut || booking.checkOutDate || booking.checkout || 'N/A'}</td>
                    <td>${booking.roomType || booking.serviceType || booking.room || 'N/A'}</td>
                    <td>${booking.guests || booking.numberOfGuests || 'N/A'}</td>
                    <td>${booking.specialRequests || booking.requests || '-'}</td>
                    <td>${booking.totalAmount || booking.amount || booking.price || '-'}</td>
                    <td><span class="status-badge ${statusClass}">${(booking.status || 'pending').toUpperCase()}</span></td>
                    <td>${booking.source === 'manual' ? ' Manual' : ' Website'}</td>
                    <td>${createdDate}<br><small style="color: #999;">${createdTime}</small></td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-icon-btn view-booking-btn" data-id="${id}" title="View Details">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                    <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                                </svg>
                            </button>
                            <button class="action-icon-btn delete-booking-btn" data-id="${id}" title="Delete">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                    <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                                </svg>
                            </button>
                        </div>
                    </td>
                </tr>
            `;
        }

        // Search bookings
        document.getElementById('bookingSearch')?.addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const rows = document.querySelectorAll('#bookingsTableBody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        });

        // Filter bookings
        document.getElementById('bookingFilter')?.addEventListener('change', function(e) {
            const filterValue = e.target.value;
            const rows = document.querySelectorAll('#bookingsTableBody tr');
            
            rows.forEach(row => {
                if (filterValue === 'all') {
                    row.style.display = '';
                } else {
                    const status = row.querySelector('.status-badge');
                    if (status) {
                        const statusText = status.textContent.toLowerCase();
                        row.style.display = statusText.includes(filterValue) ? '' : 'none';
                    }
                }
            });
        });

        // Open manual booking modal
        document.getElementById('addBookingBtn')?.addEventListener('click', function() {
            const modal = document.getElementById('addBookingModal');
            modal.classList.add('show');
            // Set minimum date to today
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('checkIn').setAttribute('min', today);
            document.getElementById('checkOut').setAttribute('min', today);
        });

        // Close booking modal
        document.getElementById('closeBookingModal')?.addEventListener('click', function() {
            const modal = document.getElementById('addBookingModal');
            modal.classList.remove('show');
            document.getElementById('addBookingForm').reset();
        });

        document.getElementById('cancelBookingModal')?.addEventListener('click', function() {
            const modal = document.getElementById('addBookingModal');
            modal.classList.remove('show');
            document.getElementById('addBookingForm').reset();
        });

        document.getElementById('addBookingModal')?.addEventListener('click', function(e) {
            if (e.target === this) {
                this.classList.remove('show');
                document.getElementById('addBookingForm').reset();
            }
        });

        // Handle booking form submission
        document.getElementById('addBookingForm')?.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const guestName = document.getElementById('guestName').value;
            const email = document.getElementById('guestEmail').value;
            const phone = document.getElementById('guestPhone').value;
            const checkIn = document.getElementById('checkIn').value;
            const checkOut = document.getElementById('checkOut').value;
            const roomType = document.getElementById('roomType').value;
            const guests = document.getElementById('guests').value;
            const status = document.getElementById('bookingStatus').value;
            
            const bookingsRef = ref(database, 'bookings');
            const newBookingRef = push(bookingsRef);
            
            set(newBookingRef, {
                guestName: guestName,
                email: email,
                phone: phone,
                checkIn: checkIn,
                checkOut: checkOut,
                roomType: roomType,
                guests: guests,
                status: status,
                createdAt: new Date().toISOString(),
                source: 'manual'
            }).then(() => {
                document.getElementById('addBookingModal').classList.remove('show');
                document.getElementById('addBookingForm').reset();
                alert('Booking created successfully!');
            }).catch((error) => {
                alert('Error creating booking: ' + error.message);
            });
        });

        // Delete booking
        document.addEventListener('click', function(e) {
            if (e.target.closest('.delete-booking-btn')) {
                const btn = e.target.closest('.delete-booking-btn');
                const bookingId = btn.getAttribute('data-id');
                
                if (confirm('Are you sure you want to delete this booking?')) {
                    const bookingRef = ref(database, 'bookings/' + bookingId);
                    remove(bookingRef).then(() => {
                        alert('Booking deleted successfully!');
                    }).catch((error) => {
                        alert('Error deleting booking: ' + error.message);
                    });
                }
            }
        });

        // ===== ENQUIRIES MANAGEMENT =====
        
        // Real-time enquiries data listener
        function loadEnquiries() {
            const enquiriesRef = ref(database, 'contact-enquiries');
            onValue(enquiriesRef, (snapshot) => {
                const tableBody = document.getElementById('enquiriesTableBody');
                const totalEnquiries = document.getElementById('totalEnquiries');
                const newEnquiries = document.getElementById('newEnquiries');
                const pendingEnquiries = document.getElementById('pendingEnquiries');
                
                tableBody.innerHTML = '';
                
                let counts = { total: 0, new: 0, pending: 0 };

                if (snapshot.exists()) {
                    const enquiries = snapshot.val();
                    const enquiriesArray = Object.keys(enquiries).map(key => ({
                        id: key,
                        ...enquiries[key]
                    }));

                    // Sort by submission date (newest first)
                    enquiriesArray.sort((a, b) => new Date(b.submittedAt) - new Date(a.submittedAt));

                    enquiriesArray.forEach(enquiry => {
                        counts.total++;
                        if (enquiry.status === 'new' || !enquiry.status) counts.new++;
                        if (enquiry.status === 'in-progress') counts.pending++;
                        
                        const row = createEnquiryRow(enquiry.id, enquiry);
                        tableBody.innerHTML += row;
                    });
                } else {
                    tableBody.innerHTML = '<tr><td colspan="9" class="no-data">No enquiries found</td></tr>';
                }

                // Update summary stats
                totalEnquiries.textContent = counts.total;
                newEnquiries.textContent = counts.new;
                pendingEnquiries.textContent = counts.pending;

                // Update main dashboard enquiries count
                const enquiryStatCard = document.querySelector('.stat-card.enquiries .stat-value');
                if (enquiryStatCard) {
                    enquiryStatCard.textContent = counts.new;
                }
            });
        }

        // Make loadEnquiries globally available
        window.loadEnquiries = loadEnquiries;

        // Create enquiry table row
        function createEnquiryRow(id, enquiry) {
            const statusClass = enquiry.status === 'resolved' ? 'resolved' : 
                              enquiry.status === 'in-progress' ? 'in-progress' : 'new';
            const statusText = enquiry.status || 'new';
            
            // Format date
            let submittedDate = 'N/A';
            let submittedTime = '';
            
            if (enquiry.submittedAt) {
                const date = new Date(enquiry.submittedAt);
                submittedDate = date.toLocaleDateString();
                submittedTime = date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            }

            // Truncate message for preview
            const messagePreview = enquiry.message ? 
                (enquiry.message.length > 50 ? enquiry.message.substring(0, 50) + '...' : enquiry.message) : 
                'No message';

            // Short ID for display
            const shortId = id.substring(0, 8);

            return `
                <tr data-enquiry-id="${id}">
                    <td><span class="enquiry-id">${shortId}</span></td>
                    <td>${enquiry.name || 'N/A'}</td>
                    <td>${enquiry.email || 'N/A'}</td>
                    <td>${enquiry.phone || 'N/A'}</td>
                    <td>${enquiry.subject || 'N/A'}</td>
                    <td>
                        <span class="enquiry-message-preview" data-full-message="${(enquiry.message || '').replace(/"/g, '&quot;')}">${messagePreview}</span>
                    </td>
                    <td><span class="status-badge ${statusClass}">${statusText.toUpperCase()}</span></td>
                    <td>${submittedDate}<br><small style="color: #999;">${submittedTime}</small></td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-icon-btn view-enquiry-btn" data-id="${id}" title="View Details">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                    <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                                </svg>
                            </button>
                            <button class="action-icon-btn delete-enquiry-btn" data-id="${id}" title="Delete">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                    <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                                </svg>
                            </button>
                        </div>
                    </td>
                </tr>
            `;
        }

        // Search enquiries
        document.getElementById('enquirySearch')?.addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const rows = document.querySelectorAll('#enquiriesTableBody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        });

        // Filter enquiries by status
        document.getElementById('enquiryFilter')?.addEventListener('change', function(e) {
            const filterValue = e.target.value;
            const rows = document.querySelectorAll('#enquiriesTableBody tr');
            
            rows.forEach(row => {
                if (filterValue === 'all') {
                    row.style.display = '';
                } else {
                    const status = row.querySelector('.status-badge');
                    if (status) {
                        const statusText = status.textContent.toLowerCase();
                        row.style.display = statusText.includes(filterValue) ? '' : 'none';
                    }
                }
            });
        });

        // View enquiry details
        document.addEventListener('click', function(e) {
            if (e.target.closest('.view-enquiry-btn') || e.target.closest('.enquiry-message-preview')) {
                const btn = e.target.closest('.view-enquiry-btn') || e.target.closest('.enquiry-message-preview');
                const enquiryId = btn.getAttribute('data-id') || btn.closest('tr').getAttribute('data-enquiry-id');
                
                // Get enquiry data from Firebase
                const enquiryRef = ref(database, 'contact-enquiries/' + enquiryId);
                onValue(enquiryRef, (snapshot) => {
                    if (snapshot.exists()) {
                        const enquiry = snapshot.val();
                        showEnquiryDetails(enquiryId, enquiry);
                    }
                }, { onlyOnce: true });
            }
        });

        // Show enquiry details modal
        function showEnquiryDetails(id, enquiry) {
            document.getElementById('detailEnquiryId').textContent = id.substring(0, 12) + '...';
            document.getElementById('detailName').textContent = enquiry.name || 'N/A';
            document.getElementById('detailEmail').textContent = enquiry.email || 'N/A';
            document.getElementById('detailPhone').textContent = enquiry.phone || 'N/A';
            document.getElementById('detailSubject').textContent = enquiry.subject || 'N/A';
            document.getElementById('detailMessage').textContent = enquiry.message || 'No message provided';
            document.getElementById('detailStatus').value = enquiry.status || 'new';
            
            const submittedDate = enquiry.submittedAt ? new Date(enquiry.submittedAt).toLocaleString() : 'N/A';
            document.getElementById('detailSubmitted').textContent = submittedDate;
            
            // Store current enquiry ID for updates
            document.getElementById('enquiryDetailsModal').setAttribute('data-enquiry-id', id);
            document.getElementById('enquiryDetailsModal').classList.add('show');
        }

        // Update enquiry status
        document.getElementById('updateEnquiryStatus')?.addEventListener('click', function() {
            const modal = document.getElementById('enquiryDetailsModal');
            const enquiryId = modal.getAttribute('data-enquiry-id');
            const newStatus = document.getElementById('detailStatus').value;
            
            const enquiryRef = ref(database, 'contact-enquiries/' + enquiryId + '/status');
            set(enquiryRef, newStatus).then(() => {
                alert('Enquiry status updated successfully!');
                modal.classList.remove('show');
            }).catch((error) => {
                alert('Error updating status: ' + error.message);
            });
        });

        // Delete enquiry
        document.addEventListener('click', function(e) {
            if (e.target.closest('.delete-enquiry-btn') || e.target.closest('#deleteEnquiry')) {
                let enquiryId;
                
                if (e.target.closest('.delete-enquiry-btn')) {
                    enquiryId = e.target.closest('.delete-enquiry-btn').getAttribute('data-id');
                } else {
                    enquiryId = document.getElementById('enquiryDetailsModal').getAttribute('data-enquiry-id');
                }
                
                if (confirm('Are you sure you want to delete this enquiry? This action cannot be undone.')) {
                    const enquiryRef = ref(database, 'contact-enquiries/' + enquiryId);
                    remove(enquiryRef).then(() => {
                        alert('Enquiry deleted successfully!');
                        document.getElementById('enquiryDetailsModal').classList.remove('show');
                    }).catch((error) => {
                        alert('Error deleting enquiry: ' + error.message);
                    });
                }
            }
        });

        // Close enquiry modal
        document.getElementById('closeEnquiryModal')?.addEventListener('click', function() {
            document.getElementById('enquiryDetailsModal').classList.remove('show');
        });

        document.getElementById('cancelEnquiryModal')?.addEventListener('click', function() {
            document.getElementById('enquiryDetailsModal').classList.remove('show');
        });

        // Make loadEnquiries available globally
        window.loadEnquiries = loadEnquiries;
        
        // Debug logging
        console.log(' Enquiries module functions loaded');
        console.log(' loadEnquiries function:', typeof window.loadEnquiries);
        console.log(' enquiriesModule element:', document.getElementById('enquiriesModule'));

        // ===== NEWSLETTER MANAGEMENT =====
        
        // Real-time newsletter subscribers data listener
        function loadNewsletterSubscribers() {
            const subscribersRef = ref(database, 'newsletter-subscribers');
            onValue(subscribersRef, (snapshot) => {
                const tableBody = document.getElementById('newsletterTableBody');
                const totalSubscribers = document.getElementById('totalSubscribers');
                const activeSubscribers = document.getElementById('activeSubscribers');
                const todaySubscribers = document.getElementById('todaySubscribers');
                
                tableBody.innerHTML = '';
                
                let counts = { total: 0, active: 0, today: 0 };
                const today = new Date().toDateString();

                if (snapshot.exists()) {
                    const subscribers = snapshot.val();
                    const subscribersArray = Object.keys(subscribers).map(key => ({
                        id: key,
                        ...subscribers[key]
                    }));

                    // Sort by subscription date (newest first)
                    subscribersArray.sort((a, b) => new Date(b.subscribedAt) - new Date(a.subscribedAt));

                    subscribersArray.forEach(subscriber => {
                        counts.total++;
                        if (subscriber.status === 'active' || !subscriber.status) counts.active++;
                        
                        // Check if subscribed today
                        const subDate = new Date(subscriber.subscribedAt).toDateString();
                        if (subDate === today) counts.today++;
                        
                        const row = createSubscriberRow(subscriber.id, subscriber);
                        tableBody.innerHTML += row;
                    });
                } else {
                    tableBody.innerHTML = '<tr><td colspan="5" class="no-data">No newsletter subscribers found</td></tr>';
                }

                // Update summary stats
                totalSubscribers.textContent = counts.total;
                activeSubscribers.textContent = counts.active;
                todaySubscribers.textContent = counts.today;

                // Update main dashboard newsletter count
                const newsletterStatCard = document.querySelector('.stat-card.newsletter .stat-value');
                if (newsletterStatCard) {
                    newsletterStatCard.textContent = counts.active;
                }
            });
        }

        // Create subscriber table row
        function createSubscriberRow(id, subscriber) {
            const statusClass = subscriber.status === 'unsubscribed' ? 'inactive' : 'active';
            const statusText = subscriber.status || 'active';
            
            // Format date
            let subscribedDate = 'N/A';
            let subscribedTime = '';
            
            if (subscriber.subscribedAt) {
                const date = new Date(subscriber.subscribedAt);
                subscribedDate = date.toLocaleDateString();
                subscribedTime = date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            }

            // Short ID for display
            const shortId = id.substring(0, 8);

            return `
                <tr data-subscriber-id="${id}">
                    <td><span class="enquiry-id">${shortId}</span></td>
                    <td>${subscriber.email || 'N/A'}</td>
                    <td><span class="status-badge ${statusClass}">${statusText.toUpperCase()}</span></td>
                    <td>${subscribedDate}<br><small style="color: #999;">${subscribedTime}</small></td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-icon-btn copy-email-btn" data-email="${subscriber.email}" title="Copy Email">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                    <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
                                </svg>
                            </button>
                            <button class="action-icon-btn ${statusClass === 'active' ? 'unsubscribe-btn' : 'resubscribe-btn'}" data-id="${id}" title="${statusClass === 'active' ? 'Unsubscribe' : 'Reactivate'}">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                    ${statusClass === 'active' 
                                        ? '<path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11H7v-2h10v2z"/>'
                                        : '<path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>'
                                    }
                                </svg>
                            </button>
                            <button class="action-icon-btn delete-subscriber-btn" data-id="${id}" title="Delete">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                    <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                                </svg>
                            </button>
                        </div>
                    </td>
                </tr>
            `;
        }

        // Search newsletter subscribers
        document.getElementById('newsletterSearch')?.addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const rows = document.querySelectorAll('#newsletterTableBody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        });

        // Filter newsletter subscribers by status
        document.getElementById('newsletterFilter')?.addEventListener('change', function(e) {
            const filterValue = e.target.value;
            const rows = document.querySelectorAll('#newsletterTableBody tr');
            
            rows.forEach(row => {
                if (filterValue === 'all') {
                    row.style.display = '';
                } else {
                    const status = row.querySelector('.status-badge');
                    if (status) {
                        const statusText = status.textContent.toLowerCase();
                        row.style.display = statusText.includes(filterValue) ? '' : 'none';
                    }
                }
            });
        });

        // Copy email to clipboard
        document.addEventListener('click', function(e) {
            if (e.target.closest('.copy-email-btn')) {
                const btn = e.target.closest('.copy-email-btn');
                const email = btn.getAttribute('data-email');
                
                navigator.clipboard.writeText(email).then(() => {
                    // Visual feedback
                    const originalHTML = btn.innerHTML;
                    btn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"/></svg>';
                    btn.style.background = '#28a745';
                    
                    setTimeout(() => {
                        btn.innerHTML = originalHTML;
                        btn.style.background = '';
                    }, 2000);
                }).catch(() => {
                    alert('Failed to copy email. Email: ' + email);
                });
            }
        });

        // Toggle subscription status
        document.addEventListener('click', function(e) {
            if (e.target.closest('.unsubscribe-btn') || e.target.closest('.resubscribe-btn')) {
                const btn = e.target.closest('.unsubscribe-btn') || e.target.closest('.resubscribe-btn');
                const subscriberId = btn.getAttribute('data-id');
                const isUnsubscribe = btn.classList.contains('unsubscribe-btn');
                const newStatus = isUnsubscribe ? 'unsubscribed' : 'active';
                const action = isUnsubscribe ? 'unsubscribe' : 'reactivate';
                
                if (confirm(`Are you sure you want to ${action} this subscriber?`)) {
                    const subscriberRef = ref(database, 'newsletter-subscribers/' + subscriberId + '/status');
                    set(subscriberRef, newStatus).then(() => {
                        alert(`Subscriber ${isUnsubscribe ? 'unsubscribed' : 'reactivated'} successfully!`);
                    }).catch((error) => {
                        alert('Error updating status: ' + error.message);
                    });
                }
            }
        });

        // Delete newsletter subscriber
        document.addEventListener('click', function(e) {
            if (e.target.closest('.delete-subscriber-btn')) {
                const btn = e.target.closest('.delete-subscriber-btn');
                const subscriberId = btn.getAttribute('data-id');
                
                if (confirm('Are you sure you want to delete this subscriber? This action cannot be undone.')) {
                    const subscriberRef = ref(database, 'newsletter-subscribers/' + subscriberId);
                    remove(subscriberRef).then(() => {
                        alert('Subscriber deleted successfully!');
                    }).catch((error) => {
                        alert('Error deleting subscriber: ' + error.message);
                    });
                }
            }
        });

        // Make loadNewsletterSubscribers available globally
        window.loadNewsletterSubscribers = loadNewsletterSubscribers;
        
        console.log(' Newsletter module functions loaded');
        console.log(' loadNewsletterSubscribers function:', typeof window.loadNewsletterSubscribers);

        // Make loadBookings available globally
        window.loadBookings = loadBookings;
    </script>

    <script>
        // Profile dropdown toggle
        const adminProfile = document.querySelector('.admin-profile');
        const profileDropdown = document.getElementById('profileDropdown');

        adminProfile.addEventListener('click', function(e) {
            e.stopPropagation();
            profileDropdown.classList.toggle('show');
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', function(e) {
            if (!adminProfile.contains(e.target) && !profileDropdown.contains(e.target)) {
                profileDropdown.classList.remove('show');
            }
        });

        // Simple navigation handling
        document.querySelectorAll('.sidebar-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                
                // Remove active class from all links
                document.querySelectorAll('.sidebar-link').forEach(l => l.classList.remove('active'));
                
                // Add active class to clicked link
                this.classList.add('active');
                
                // Get the module name
                const module = this.getAttribute('href').substring(1);
                
                // Update content header
                const title = this.querySelector('span').textContent;
                document.querySelector('.content-title').textContent = title;
                
                // Show/hide content based on module
                const dashboardStats = document.getElementById('dashboardStats');
                const quickActions = document.querySelector('.quick-actions');
                const chartsContainer = document.querySelector('.charts-container');
                const otherContent = document.getElementById('otherContent');
                const customersModule = document.getElementById('customersModule');
                const bookingsModule = document.getElementById('bookingsModule');
                const enquiriesModule = document.getElementById('enquiriesModule');
                const newsletterModule = document.getElementById('newsletterModule');
                
                if (module === 'dashboard') {
                    dashboardStats.style.display = 'grid';
                    quickActions.style.display = 'flex';
                    chartsContainer.style.display = 'grid';
                    otherContent.style.display = 'none';
                    customersModule.style.display = 'none';
                    bookingsModule.style.display = 'none';
                    enquiriesModule.style.display = 'none';
                    newsletterModule.style.display = 'none';
                } else if (module === 'customers') {
                    dashboardStats.style.display = 'none';
                    quickActions.style.display = 'none';
                    chartsContainer.style.display = 'none';
                    otherContent.style.display = 'none';
                    customersModule.style.display = 'block';
                    bookingsModule.style.display = 'none';
                    enquiriesModule.style.display = 'none';
                    newsletterModule.style.display = 'none';
                    // Load customers when module is opened
                    if (window.loadCustomers) {
                        window.loadCustomers();
                    }
                } else if (module === 'bookings') {
                    dashboardStats.style.display = 'none';
                    quickActions.style.display = 'none';
                    chartsContainer.style.display = 'none';
                    otherContent.style.display = 'none';
                    customersModule.style.display = 'none';
                    bookingsModule.style.display = 'block';
                    enquiriesModule.style.display = 'none';
                    newsletterModule.style.display = 'none';
                    // Load bookings when module is opened
                    if (window.loadBookings) {
                        window.loadBookings();
                    }
                } else if (module === 'enquiries') {
                    console.log(' Switching to enquiries module');
                    dashboardStats.style.display = 'none';
                    quickActions.style.display = 'none';
                    chartsContainer.style.display = 'none';
                    otherContent.style.display = 'none';
                    customersModule.style.display = 'none';
                    bookingsModule.style.display = 'none';
                    enquiriesModule.style.display = 'block';
                    newsletterModule.style.display = 'none';
                    console.log(' Enquiries module display set to block');
                    // Load enquiries when module is opened
                    if (window.loadEnquiries) {
                        console.log(' Calling loadEnquiries function');
                        window.loadEnquiries();
                    } else {
                        console.error(' loadEnquiries function not found');
                    }
                } else if (module === 'newsletter') {
                    console.log(' Switching to newsletter module');
                    dashboardStats.style.display = 'none';
                    quickActions.style.display = 'none';
                    chartsContainer.style.display = 'none';
                    otherContent.style.display = 'none';
                    customersModule.style.display = 'none';
                    bookingsModule.style.display = 'none';
                    enquiriesModule.style.display = 'none';
                    newsletterModule.style.display = 'block';
                    console.log(' Newsletter module display set to block');
                    // Load newsletter subscribers when module is opened
                    if (window.loadNewsletterSubscribers) {
                        console.log(' Calling loadNewsletterSubscribers function');
                        window.loadNewsletterSubscribers();
                    } else {
                        console.error(' loadNewsletterSubscribers function not found');
                    }
                } else {
                    dashboardStats.style.display = 'none';
                    quickActions.style.display = 'none';
                    chartsContainer.style.display = 'none';
                    otherContent.style.display = 'flex';
                    customersModule.style.display = 'none';
                    bookingsModule.style.display = 'none';
                    enquiriesModule.style.display = 'none';
                    newsletterModule.style.display = 'none';
                    otherContent.querySelector('p').textContent = `${title} content will be displayed here...`;
                }
            });
        });

        // Initialize Charts
        function initializeCharts() {
            console.log(' Initializing charts...');
            
            // Booking Trends Chart (Line Chart)
            const bookingCtx = document.getElementById('bookingChart');
            if (bookingCtx) {
                console.log(' Booking chart canvas found');
                bookingChart = new Chart(bookingCtx, {
                    type: 'line',
                    data: {
                        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                        datasets: [{
                            label: 'Bookings',
                            data: [0, 0, 0, 0, 0, 0],
                            borderColor: '#FF6B35',
                            backgroundColor: 'rgba(255, 107, 53, 0.1)',
                            tension: 0.4,
                            fill: true,
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        aspectRatio: 2,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    stepSize: 1
                                }
                            }
                        }
                    }
                });
                console.log(' Booking chart created');
            } else {
                console.error(' Booking chart canvas not found');
            }

            // Customer Activity Chart (Bar Chart)
            const activityCtx = document.getElementById('activityChart');
            if (activityCtx) {
                console.log(' Activity chart canvas found');
                activityChart = new Chart(activityCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
                        datasets: [{
                            label: 'New Customers',
                            data: [0, 0, 0, 0, 0, 0, 0],
                            backgroundColor: '#4CAF50',
                            borderRadius: 5
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        aspectRatio: 2,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    stepSize: 1
                                }
                            }
                        }
                    }
                });
                console.log(' Activity chart created');
            } else {
                console.error(' Activity chart canvas not found');
            }

            // Client Behavior Chart (Doughnut Chart)
            const behaviorCtx = document.getElementById('behaviorChart');
            if (behaviorCtx) {
                console.log(' Behavior chart canvas found');
                behaviorChart = new Chart(behaviorCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Pending', 'Active', 'Completed'],
                        datasets: [{
                            data: [0, 0, 0],
                            backgroundColor: [
                                '#FFA726',
                                '#2196F3',
                                '#4CAF50'
                            ],
                            borderWidth: 2,
                            borderColor: '#fff'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        aspectRatio: 1.5,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 15,
                                    font: {
                                        size: 12
                                    }
                                }
                            }
                        }
                    }
                });
                console.log(' Behavior chart created');
            } else {
                console.error(' Behavior chart canvas not found');
            }

            console.log(' Chart initialization complete');
        }

        // Initialize charts when page loads
        window.addEventListener('DOMContentLoaded', initializeCharts);

        // Quick Action Button Handlers
        document.addEventListener('DOMContentLoaded', function() {
            // Get all quick action buttons
            const quickActionButtons = document.querySelectorAll('.quick-actions .action-btn');
            
            if (quickActionButtons.length >= 3) {
                // New Booking button (first button)
                quickActionButtons[0].addEventListener('click', function() {
                    // Switch to bookings module
                    document.querySelector('a[href="#bookings"]').click();
                    // Open add booking modal after a short delay
                    setTimeout(() => {
                        const addBookingBtn = document.getElementById('addBookingBtn');
                        if (addBookingBtn) {
                            addBookingBtn.click();
                        }
                    }, 100);
                });

                // Add Customer button (second button)
                quickActionButtons[1].addEventListener('click', function() {
                    // Switch to customers module
                    document.querySelector('a[href="#customers"]').click();
                    // Open add customer modal after a short delay
                    setTimeout(() => {
                        const addCustomerBtn = document.getElementById('addCustomerBtn');
                        if (addCustomerBtn) {
                            addCustomerBtn.click();
                        }
                    }, 100);
                });

                // Newsletter button (third button)
                quickActionButtons[2].addEventListener('click', function() {
                    // Switch to newsletter module
                    document.querySelector('a[href="#newsletter"]').click();
                });
            }
        });
    </script>
</body>
</html>